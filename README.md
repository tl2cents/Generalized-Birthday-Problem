
The repository contains the codes that accompany the paper "Revisiting the Generalized Birthday Problem and Equihash: Single or K Lists?". The eprint version of the paper will soon be available. In this work, we revisit the following two long-conflated problems and fill in theoretical gaps in solving the single-list variant of $\textsf{GBP}$.

**Definition. *Strict Generalized Birthday Problem.*** $\textsf{SGBP}(n, K)$: Given $K$ lists $L_1, \ldots, L_K$ containing random $n$-bit values, the strict generalized birthday problem involves finding $x_1 \in L_1, \ldots, x_K \in L_K$ such that 

$$
x_1 \oplus x_2 \oplus \cdots \oplus x_K = 0.
$$

**Definition. *Loose Generalized Birthday Problem.*** $\textsf{LGBP}(n, K)$: Given a list $L$ containing random $n$-bit values, the loose generalized birthday problem involves finding $x_1, \ldots, x_K \in L$ such that 

$$
x_1 \oplus x_2 \oplus \cdots \oplus x_K = 0.
$$


Accompanied by the following codes:

- The estimating codes for our main analyzing results including time/memory complexity of Wagner's algorithmic framework,  $\textsf{iSHAKE}$ and our new Proposal $\textsf{Sequihash}$.
- The proof of concept python codes implementing the optimized single-list algorithm, k-list algorithm and our improved trade-offs.
- The linearization attacks for both $\textsf{LGBP}$ and $\textsf{SGBP}$ over $\mathbb{F}_2$.


## Pre-requisites 

Testing Env: Sagemath 10.3 with Python 3.11.9.

Additional Requisites :

- `prettytable` lib:  install by `pip install prettytable`
- `pycryptodome` lib: install by `pip install pycryptodome`


## Estimating Codes

Codes for our analyzing results in sub-directory `/esitmator`:

- `single-list-optimal-k.ipynb`：the expected number of solutions for single-list algorithm. Support Lemma 1, 3 and our main Theorem 1.
- `all-in-one-estimator.ipynb`：our analysis codes for $\textsf{iSHAKE}$  and the summary of $\textsf{GBP}$.
- `sequihash-paras.ipynb`： estimator for Proof-of-Works: $\textsf{Equihash}, \textsf{Sequihash}$.
- `trade_off_index_pointer.ipynb`: estimators for improved trade-offs and index-pointer technique.


## K-list and Single-list Algorithms

Proof-of-concept implementations in sub-directory `/GBP-solver`:

- `k_list.py` : the implementation of Wagner's k-list algorithm for $\textsf{SGBP}$.
- `single_list.py`: the implementation of single-list algorithm for $\textsf{LGBP}$.
- `optimized_single_list.py`: the implementation of our optimized single-list algorithm for $\textsf{LGBP}$ using index pointers and duplicate check.
- `single_list_trade_off.py` and `k_list_trade_off.py`: improved trade-off for Wagner's algorithmic framework.
- `secondary_solutions.py`: the codes to analyze the number of secondary solutions generated by the optimized single-list algorithm when $k \approx \sqrt{\frac{n}{2} + 1}$.
- Others: some results of our scripts for verifying the correctness of our implementations.

We present some test results of memory peaks in comment. It is important to note that our Python implementation serves merely as a proof of concept and does not represent the most memory-efficient implementations.




## Linearization Attacks

Linearization Attacks for $\textsf{LGBP}$ and $\textsf{SGBP}$ in sub-directory `/linearization-attacks`:

- `lgbp-linearization-attack.ipynb`: the linearization attacks on $\textsf{LGBP}(n,k)$ with $k \ge \frac{n}{2}$.
- `sgbp-linearization-attack-XHASH.ipynb`: the linearization attacks on $\textsf{SGBP}(n,k)$ with $k \ge {n}$. We take XHASH as a concrete example to show this attack.
 


